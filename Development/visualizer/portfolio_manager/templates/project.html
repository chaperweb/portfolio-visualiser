{% extends "base.html" %}

{# TITLE HERE #}
{% block title %}
Projects | {{project.name}}
{% endblock %}

{# CSS HERE #}
{% block css %}
{% load static %}
<link rel="stylesheet" href="{% static "portfolio_manager/css/sidebar.css" %}">
<link rel="stylesheet" href="{% static "portfolio_manager/css/admin_tools.css" %}">
{% endblock %}

{% block javascript %}
{% load static%}
<script src="{% static "portfolio_manager/js/modify_project.js" %}"></script>
{% endblock %}

{# CONTENT HERE #}
{% block content %}
{% load tz %}
{% load project_tags %}
<!-- Sidebar -->
<div class="sidebar navbar-fixed-left navbar-inverse xs-hidden col-md-2">
  <ul class="nav navbar-nav">
    <!-- Press this list item to show all the projects -->
    <li data-toggle="collapse" data-target="#projects" class="navbar-toggle sidebar-item">Projects</li>
    <li>
      <!-- Expandable list with all the projects -->
      <div id="projects" class="collapse in">
        <ul class="nav">
          {% for p in projects %}
            <li><a class="sidebar-subitem" href="/projects/{{p.pk}}">{{p.name}}</a></li>
          {% endfor %}
        </ul>
      </div>
    </li>
  </ul>
</div>
<!-- /sidebar -->

<!-- Modals -->
<div id="modal-wrapper">
  {% include "modals/modify_text_modal.html" %}
  {% include "modals/modify_org_modal.html" %}
  {% include "modals/modify_dec_modal.html" %}
  {% include "modals/modify_per_modal.html" %}
  {% include "modals/modify_date_modal.html" %}
  {% include "modals/modify_assorg_modal.html" %}
  {% include "modals/multiple_items_modal.html" %}
</div>

<!-- Page Content -->
<div id="page-content-wrapper" class="container col-lg-10">
  <div class="col-md-8 col-md-offset-2">
    <div class="title text-center" id="project-name">
      <b>{{ project.name }}</b>
    </div>
    {% for key, value in testdims.items %}
      <h4><u>{{ key | ct_name | upper }} FIELDS: </u></h4>
      {% for dim_name, dim_obj in value.items %}
        <div class="panel-group" id="project-dimension-panels">
          <div class="panel panel-default">
            <div class="panel-heading row"
                data-toggle="collapse"
                href="#{{dim_name}}-panel"
                aria-controls="#{{dim_name}}-panel"
                aria-expanded="false">
              <!--  Triangles  -->
              <div class="col-lg-1">
                <span class="glyphicon glyphicon-triangle-bottom" aria-hidden="true"></span>
                <span class="glyphicon glyphicon-triangle-top" aria-hidden="true"></span>
              </div>
              <!--  Name of dimension  -->
              <div class="col-lg-2">
                {{ dim_name }}
              </div>
              <!--  Value of dimension  -->
              <div id="{{dim_name}}" class="col-lg-3 col-lg-offset-3">
                {{ dim_obj | stringformat:"s" }}
              </div>
              <!--  Modify button  -->
              <div class="col-md-1 pull-right">
                <button class="btn btn-xs btn-default open-modify-{{key|get_type}} modify-button"
                    data-type="text"
                    data-field="{{dim_name}}"
                    data-value="{{ dim_obj | stringformat:"s" }}"
                    data-toggle="modal"
                    data-target="#modify-{{key|get_type}}-modal">
                  Modify
                </button>
              </div>
            </div>
            <!--  The history box  -->
            <div id="{{dim_name}}-panel" class="panel-collapse panel-body collapse row">
              <table class="table">
                <thead>
                  <tr>
                    <th>Date</th>
                    <th>Value</th>
                  </tr>
                </thead>
                <tbody>
                  {% for i in dim_obj.history.all %}
                    {% if forloop.counter < 6 %}
                      <tr>
                        <td>{{i.history_date}}</td>
                        <td>{{i.value}}</td>
                      </tr>
                    {% endif %}
                	{% endfor %}
                </tbody>
              </table>
            </div>
          </div>
        </div>
      {% endfor %}
    {% endfor %}

    <!-- OLD VERSION BELOW --

    <!-- Project name --
    <div class="title text-center" id="project-name"><b>{{ project.name }}</b></div>
    <div class="panel-group" id="project-dimension-panels">
      <!-- ORGANIZATION --
      <div class="panel panel-default">
        <div class="panel-heading row" data-toggle="collapse" data-target="#org-panel" aria-controls="#org-panel" aria-expanded="false">
          <div class="col-md-1">
            <span class="glyphicon glyphicon-triangle-bottom" aria-hidden="true"></span>
            <span class="glyphicon glyphicon-triangle-top" aria-hidden="true"></span>
          </div>
          <div class="col-md-2">Organization</div>
          <div id="projectparent" class="col-lg-3 col-lg-offset-3">{{ project.parent }}</div>
          <div class="col-md-1 pull-right modifybutton">
            <button class="btn btn-xs btn-default open-modify modify-button" data-type="text" data-field="Organization" data-value="{{project.parent}}" data-toggle="modal" data-target="#modify-org-modal">
              Modify
            </button>
          </div>
        </div>
        <div id="org-panel" class="panel-collapse panel-body collapse row">
          <table class="table">
            <thead>
              <tr>
                <th>Date</th>
                <th>Value</th>
              </tr>
            </thead>
            <tbody>
            {% for date, org in orghistory %}
              <tr>
                <td>{{date}}</td>
                <td>{{org}}</td>
              </tr>
            {% endfor %}
            </tbody>
          </table>
        </div>
      </div>
      <!-- BUDGET --
      <div class="panel panel-default">
        <div class="panel-heading row" data-toggle="collapse" href="#budget-panel" aria-controls="#budget-panel" aria-expanded="false">
          <div class="col-lg-1">
            <span class="glyphicon glyphicon-triangle-bottom" aria-hidden="true"></span>
            <span class="glyphicon glyphicon-triangle-top" aria-hidden="true"></span>
          </div>
          <div class="col-lg-2">
            Budget:
          </div>
          <div id="{{ budget.dimension_object.name }}" class="col-lg-3 col-lg-offset-3">
            {{ budget.dimension_object.value }}
          </div>
          <div class="col-md-1 pull-right">
          <button class="btn btn-xs btn-default open-modify-dec modify-button" data-type="number" data-field="{{ budget.dimension_object.name }}" data-value="{{budget.dimension_object.value}}" data-toggle="modal" data-target="#modify-dec-modal">
            Modify
          </button>
          </div>
        </div>
        <div id="budget-panel" class="panel-collapse panel-body collapse row">
          <table class="table">
            <thead>
              <tr>
                <th>Date</th>
                <th>Value</th>
              </tr>
            </thead>
            <tbody>
              {% for i in budget.dimension_object.history.all %}
              {% if forloop.counter < 6 %}
              <tr>
                <td>{{i.history_date}}</td>
                <td>{{i.value}}</td>
              </tr>
              {% endif %}
            	{% endfor %}
            </tbody>
          </table>
        </div>
      </div>
      <!-- DATE FIELDS --
      {% for x in dates %}
        <div class="panel panel-default">
          <div class="panel-heading row" data-toggle="collapse" href="#{{x.dimension_object.name}}-panel" aria-controls="#{{x.dimension_object.name}}-panel" aria-expanded="false">
            <div class="col-lg-1">
              <span class="glyphicon glyphicon-triangle-bottom" aria-hidden="true"></span>
              <span class="glyphicon glyphicon-triangle-top" aria-hidden="true"></span>
            </div>
            <div class="col-lg-2">
              {{x.dimension_object.name}}:
            </div>
            <div id="{{x.dimension_object.name}}" class="col-lg-3 col-lg-offset-3">
              {{ x.dimension_object.value|date:"F j, Y" }}
            </div>
            <div class="col-md-1 pull-right">
              <button class="btn btn-xs btn-default open-modify-date modify-button" data-type="text" data-field="{{x.dimension_object.name}}" data-value="{{ x.dimension_object.value }}" data-toggle="modal" data-target="#modify-date-modal">
                Modify
              </button>
            </div>
          </div>
          <div id="{{x.dimension_object.name}}-panel" class="panel-collapse panel-body collapse row">
            <table class="table">
              <thead>
              <tr>
                <th>Date</th>
                <th>Value</th>
              </tr>
            </thead>
            <tbody>
            {% for i in x.dimension_object.history.all %}
            {% if forloop.counter < 6 %}
            <tr>
              <td>{{i.history_date}}</td>
              <td>{{i.value}}</td>
            </tr>
            {% endif %}
          	{% endfor %}
          </tbody>
        </table>
          </div>
        </div>
      {% endfor %}
      <!-- TEXT FIELDS --
      {% for x in text %}
        <div class="panel panel-default">
          <div class="panel-heading row" data-toggle="collapse" href="#{{x.dimension_object.name}}-panel" aria-controls="#{{x.dimension_object.name}}-panel" aria-expanded="false">
            <div class="col-lg-1">
              <span class="glyphicon glyphicon-triangle-bottom" aria-hidden="true"></span>
              <span class="glyphicon glyphicon-triangle-top" aria-hidden="true"></span>
            </div>
            <div class="col-lg-2">
              {{x.dimension_object.name}}:
            </div>
            <div id="{{x.dimension_object.name}}" class="col-lg-3 col-lg-offset-3">
              {{ x.dimension_object.value }}
            </div>
            <div class="col-md-1 pull-right">
              <button class="btn btn-xs btn-default open-modify-text modify-button" data-type="text" data-field="{{x.dimension_object.name}}" data-value="{{ x.dimension_object.value }}" data-toggle="modal" data-target="#modify-text-modal">
                Modify
              </button>
            </div>
          </div>
          <div id="{{x.dimension_object.name}}-panel" class="panel-collapse panel-body collapse row">
            <table class="table">
              <thead>
              <tr>
                <th>Date</th>
                <th>Value</th>
              </tr>
            </thead>
            <tbody>
            {% for i in x.dimension_object.history.all %}
            {% if forloop.counter < 6 %}
            <tr>
              <td>{{i.history_date}}</td>
              <td>{{i.value}}</td>
            </tr>
            {% endif %}
            {% endfor %}
          </tbody>
        </table>
          </div>
        </div>
      {% endfor %}
      <!-- DECIMAL FIELDS --
      {% for x in decfield %}
        <div class="panel panel-default">
          <div class="panel-heading row" data-toggle="collapse" href="#{{x.dimension_object.name}}-panel" aria-controls="#{{x.dimension_object.name}}-panel" aria-expanded="false">
            <div class="col-lg-1">
              <span class="glyphicon glyphicon-triangle-bottom" aria-hidden="true"></span>
              <span class="glyphicon glyphicon-triangle-top" aria-hidden="true"></span>
            </div>
            <div class="col-lg-2">
              {{x.dimension_object.name}}:
            </div>
            <div id="{{x.dimension_object.name}}" class="col-lg-3 col-lg-offset-3">
              {{ x.dimension_object.value }}
            </div>
            <div class="col-md-1 pull-right">
              <button class="btn btn-xs btn-default open-modify-dec modify-button" data-type="number" data-field="{{x.dimension_object.name}}" data-value="{{ x.dimension_object.value }}" data-toggle="modal" data-target="#modify-dec-modal">
                Modify
              </button>
            </div>
          </div>
          <div id="{{x.dimension_object.name}}-panel" class="panel-collapse panel-body collapse row">
            <table class="table">
              <thead>
                <tr>
                  <th>Date</th>
                  <th>Value</th>
                </tr>
              </thead>
              <tbody>
              {% for i in x.dimension_object.history.all %}
              {% if forloop.counter < 6 %}
              <tr>
                <td>{{i.history_date}}</td>
                <td>{{i.value}}</td>
              </tr>
              {% endif %}
            	{% endfor %}
              </tbody>
            </table>
          </div>
        </div>
      {% endfor %}
      <!-- ASSOCIATED ORGANIZATION FIELDS --
      {% for x in assOrg %}
        <div class="panel panel-default">
          <div class="panel-heading row" data-toggle="collapse" href="#{{x.dimension_object.name}}-panel" aria-controls="#{{x.dimension_object.name}}-panel" aria-expanded="false">
            <div class="col-lg-1">
              <span class="glyphicon glyphicon-triangle-bottom" aria-hidden="true"></span>
              <span class="glyphicon glyphicon-triangle-top" aria-hidden="true"></span>
            </div>
            <div class="col-lg-2">
              {{x.dimension_object.name}}:
            </div>
            <div id="{{x.dimension_object.name}}" class="col-lg-3 col-lg-offset-3">
              {{ x.dimension_object.value }}
            </div>
            <div class="col-md-1 pull-right">
              <button class="btn btn-xs btn-default open-modify-assorg modify-button" data-type="text" data-field="{{x.dimension_object.name}}" data-value="{{ x.dimension_object.value }}" data-toggle="modal" data-target="#modify-assorg-modal">
                Modify
              </button>
            </div>
          </div>
          <div id="{{x.dimension_object.name}}-panel" class="panel-collapse panel-body collapse row">
            <table class="table">
              <thead>
                <tr>
                  <th>Date</th>
                  <th>Value</th>
                </tr>
              </thead>
              <tbody>
              {% for i in x.dimension_object.history.all %}
              {% if forloop.counter < 6 %}
              <tr>
                <td>{{i.history_date}}</td>
                <td>{{i.value}}</td>
              </tr>
              {% endif %}
            	{% endfor %}
              </tbody>
            </table>
          </div>
        </div>
      {% endfor %}
      <!-- ASSOCIATED PERSON FIELDS --
      {% for x in assPerson %}
        <div class="panel panel-default">
          <div class="panel-heading row" data-toggle="collapse" href="#{{x.dimension_object.name}}-panel" aria-controls="#{{x.dimension_object.name}}-panel" aria-expanded="false">
            <div class="col-lg-1">
              <span class="glyphicon glyphicon-triangle-bottom" aria-hidden="true"></span>
              <span class="glyphicon glyphicon-triangle-top" aria-hidden="true"></span>
            </div>
            <div class="col-lg-2">
              {{x.dimension_object.name}}:
            </div>
            <div id="{{x.dimension_object.name}}" class="col-lg-3 col-lg-offset-3">
              {{ x.dimension_object.value }}
            </div>
            <div class="col-md-1 pull-right">
              <button class="btn btn-xs btn-default open-modify-per modify-button" data-type="text" data-field="{{x.dimension_object.name}}" data-value="{{ x.dimension_object.value }}" data-toggle="modal" data-target="#modify-per-modal">
                Modify
              </button>
            </div>
          </div>
          <div id="{{x.dimension_object.name}}-panel" class="panel-collapse panel-body collapse row">
            <table class="table">
              <thead>
              <tr>
                <th>Date</th>
                <th>Value</th>
              </tr>
            </thead>
            <tbody>
            {% for i in x.dimension_object.history.all %}
            {% if forloop.counter < 6 %}
            <tr>
              <td>{{i.history_date}}</td>
              <td>{{i.value}}</td>
            </tr>
            {% endif %}
            {% endfor %}
          </tbody>
        </table>
          </div>
        </div>
      {% endfor %}
      <!-- ASSOCIATED PERSONS FIELDS --
      {% for x in assPersons %}
        <div class="panel panel-default">
          <div class="panel-heading row" href="#{{x.dimension_object.name}}-panel" aria-controls="#{{x.dimension_object.name}}-panel" aria-expanded="false">
            <div class="col-lg-1">

            </div>
            <div class="col-lg-2">
              {{x.dimension_object.name}}:
            </div>
            <div id="{{x.dimension_object.name}}" class="col-lg-3 col-lg-offset-3">
              <button type="button" class="btn btn-xs btn-success multiple-button modify-button" data-projectid="{{project.pk}}" data-type="asspersons" data-field="{{ x.dimension_object.name }}" data-toggle="modal" data-target="#multiple-items-modal">Click to see all</button>
            </div>
            <div class="col-md-1 pull-right">
              <button class="btn btn-xs btn-default open-modify-text modify-button multiple-modify-button" data-projectid="{{project.pk}}" data-type="asspersons" data-field="{{x.dimension_object.name}}" data-value="{{ x.dimension_object.value }}" data-toggle="modal" data-target="#multiple-items-modal">
                Modify
              </button>
            </div>
          </div>
        </div>
      {% endfor %}
      <!-- ASSOCIATED PROJECTS FIELDS --
      {% for x in assProjs %}
        <div class="panel panel-default">
          <div class="panel-heading row"  href="#{{x.dimension_object.name}}-panel" aria-controls="#{{x.dimension_object.name}}-panel" aria-expanded="false">
            <div class="col-lg-1">
            </div>
            <div class="col-lg-2">
              {{x.dimension_object.name}}:
            </div>
            <div id="{{x.dimension_object.name}}" class="col-lg-3 col-lg-offset-3">
              <button type="button" class="btn btn-xs btn-success multiple-button modify-button" data-projectid="{{project.pk}}" data-type="assprojects" data-field="{{ x.dimension_object.name }}" data-toggle="modal" data-target="#multiple-items-modal">Click to see all</button>
            </div>
            <div class="col-md-1 pull-right">
              <button class="btn btn-xs btn-default open-modify-text modify-button multiple-modify-button" data-projectid="{{project.pk}}" data-type="assprojects" data-field="{{x.dimension_object.name}}" data-value="{{ x.dimension_object.value }}" data-toggle="modal" data-target="#multiple-items-modal">
                Modify
              </button>
            </div>
          </div>

        </div>
      {% endfor %}
    </div>
  </div>
</div>
<!-- /page-content-wrapper -->
{% endblock %}
